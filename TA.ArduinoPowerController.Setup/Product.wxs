<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">

  <?include $(sys.CURRENTDIR)\Config.wxi?>
  <Product Id="*" 
           Name="$(var.InstallName)" 
           Language="1033" Version="$(var.ProductVersion)" 
           Manufacturer="$(var.Manufacturer)" 
           UpgradeCode="$(var.UpgradeCode)">
		<Package InstallerVersion="400" Compressed="yes" InstallScope="perMachine" />
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." 
                  AllowSameVersionUpgrades="no"/>
		<MediaTemplate EmbedCab="yes" />
    <FeatureGroupRef Id="fgRoot"/>

    <!-- Requires .NET Framework 4.8 or later --><!--
    <PropertyRef Id="WIX_IS_NETFRAMEWORK_48_OR_LATER_INSTALLED" />
    <Condition Message="This application requires .NET Framework 4.8. Please install the .NET Framework then run this installer again.">
      <![CDATA[Installed OR WIX_IS_NETFRAMEWORK_48_OR_LATER_INSTALLED]]>
    </Condition>-->

    <!-- Launch Condition to check that x64 installer is used on x64 systems and x86 installer on x86 systems -->
    <!-- Credit to Yan Sklyarenko via Stack Overflow for suggesting this format       -->
    <Condition Message="Please use the correct installer for your operating system - x86 for 32-bit, x64 for 64-bit.">
      <?if $(var.Win64) = "yes" ?>
      VersionNT64
      <?else?>
      NOT VersionNT64
      <?endif?>
    </Condition>

    <!-- Condition: Windows 7 or later -->
    <Condition Message="This product requires Windows 7 or later">
      <?if $(var.Win64) = "yes" ?>
      <![CDATA[Installed OR (VersionNT64 >= 601)]]>
      <?else?>
      <![CDATA[Installed OR (VersionNT >= 601)]]>
      <?endif?>
    </Condition>
  </Product>
</Wix>
